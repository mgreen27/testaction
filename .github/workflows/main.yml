name: Create Archive
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Update vql
      run: |
        cd ./scripts
        for x in $( ls *.py ); do
          python3 $i
        done 
        ls -l vql/*.yaml
        python -V
    - uses: stefanzweifel/git-auto-commit-action@v4
      with:
        commit_message: Automated VQL update
        file_pattern: "*.yaml"
        repository: .
    - name: Zip Folder
      run: zip -r DetectRaptorVQL.zip vql/*.yaml
    - uses: ncipollo/release-action@v1
      with:
        artifacts: DetectRaptorVQL.zip
        tag: DetectRaptor
        allowUpdates: true
